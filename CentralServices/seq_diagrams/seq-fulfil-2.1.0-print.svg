<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1467px" preserveAspectRatio="none" style="width:1449px;height:1467px;" version="1.1" viewBox="0 0 1449 1467" width="1449px" zoomAndPan="magnify"><defs><filter height="300%" id="f1v433rctvyuan" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="374" x="538.5" y="23.5352">2.1.0. DFSP2 sends a Fulfil Success Transfer request</text><rect fill="#D3D3D3" height="1421.5488" style="stroke: #A80036; stroke-width: 1.0;" width="122" x="26" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60" x="57" y="47.0566">Financial</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="116" x="29" y="62.3672">Service Providers</text><rect fill="#ADD8E6" height="1421.5488" style="stroke: #A80036; stroke-width: 1.0;" width="296" x="275.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="345" y="47.0566">ML API Adapter Service</text><rect fill="#FFFFE0" height="1421.5488" style="stroke: #A80036; stroke-width: 1.0;" width="848.5" x="573.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="947.25" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="264.416" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="329.5" y="328.2598"/><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="1163.9746" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="495.5" y="179.0859"/><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="117.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="692.5" y="445.8125"/><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="1163.9746" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="809.5" y="179.0859"/><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="1163.9746" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1050.5" y="179.0859"/><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="1163.9746" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1261.5" y="179.0859"/><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="1149.9746" style="stroke: #000000; stroke-width: 2.0;" width="1425" x="13" y="186.0859"/><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="1405" x="23" y="995.6445"/><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="1346" x="82" y="1171.5078"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="57" x2="57" y1="169.0859" y2="1353.0605"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="116" x2="116" y1="169.0859" y2="1353.0605"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="334.5" x2="334.5" y1="169.0859" y2="1353.0605"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="500.5" x2="500.5" y1="169.0859" y2="1353.0605"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="617.5" x2="617.5" y1="169.0859" y2="1353.0605"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="697.5" x2="697.5" y1="169.0859" y2="1353.0605"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="814.5" x2="814.5" y1="169.0859" y2="1353.0605"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="906" x2="906" y1="169.0859" y2="1353.0605"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="985" x2="985" y1="169.0859" y2="1353.0605"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1055" x2="1055" y1="169.0859" y2="1353.0605"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1156.5" x2="1156.5" y1="169.0859" y2="1353.0605"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1266.5" x2="1266.5" y1="169.0859" y2="1353.0605"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1367" x2="1367" y1="169.0859" y2="1353.0605"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="33" y="149.6445">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="36" y="166.1328">Payer</text><ellipse cx="57.5" cy="79.1094" fill="#FEFECE" filter="url(#f1v433rctvyuan)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M57.5,87.1094 L57.5,114.1094 M44.5,95.1094 L70.5,95.1094 M57.5,114.1094 L44.5,129.1094 M57.5,114.1094 L70.5,129.1094 " fill="none" filter="url(#f1v433rctvyuan)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="33" y="1365.5957">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="36" y="1382.084">Payer</text><ellipse cx="57.5" cy="1395.0371" fill="#FEFECE" filter="url(#f1v433rctvyuan)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M57.5,1403.0371 L57.5,1430.0371 M44.5,1411.0371 L70.5,1411.0371 M57.5,1430.0371 L44.5,1445.0371 M57.5,1430.0371 L70.5,1445.0371 " fill="none" filter="url(#f1v433rctvyuan)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="92" y="149.6445">DFSP2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="94" y="166.1328">Payee</text><ellipse cx="116.5" cy="79.1094" fill="#FEFECE" filter="url(#f1v433rctvyuan)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M116.5,87.1094 L116.5,114.1094 M103.5,95.1094 L129.5,95.1094 M116.5,114.1094 L103.5,129.1094 M116.5,114.1094 L129.5,129.1094 " fill="none" filter="url(#f1v433rctvyuan)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="92" y="1365.5957">DFSP2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="94" y="1382.084">Payee</text><ellipse cx="116.5" cy="1395.0371" fill="#FEFECE" filter="url(#f1v433rctvyuan)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M116.5,1403.0371 L116.5,1430.0371 M103.5,1411.0371 L129.5,1411.0371 M116.5,1430.0371 L103.5,1445.0371 M116.5,1430.0371 L129.5,1445.0371 " fill="none" filter="url(#f1v433rctvyuan)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="279.5" y="166.1328">ML API Adapter</text><path d="M314,124.5977 L314,148.5977 M314,136.5977 L331,136.5977 " fill="none" filter="url(#f1v433rctvyuan)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="343" cy="136.5977" fill="#FEFECE" filter="url(#f1v433rctvyuan)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="279.5" y="1365.5957">ML API Adapter</text><path d="M314,1372.5488 L314,1396.5488 M314,1384.5488 L331,1384.5488 " fill="none" filter="url(#f1v433rctvyuan)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="343" cy="1384.5488" fill="#FEFECE" filter="url(#f1v433rctvyuan)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="433.5" y="149.6445">ML API Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="95" x="450" y="166.1328">Event Handler</text><ellipse cx="500.5" cy="120.1094" fill="#FEFECE" filter="url(#f1v433rctvyuan)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="496.5,108.1094,502.5,103.1094,500.5,108.1094,502.5,113.1094,496.5,108.1094" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="433.5" y="1365.5957">ML API Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="95" x="450" y="1382.084">Event Handler</text><ellipse cx="500.5" cy="1401.0371" fill="#FEFECE" filter="url(#f1v433rctvyuan)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="496.5,1389.0371,502.5,1384.0371,500.5,1389.0371,502.5,1394.0371,496.5,1389.0371" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="589.5" y="149.6445">Central</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="577.5" y="166.1328">Service API</text><path d="M597,108.1094 L597,132.1094 M597,120.1094 L614,120.1094 " fill="none" filter="url(#f1v433rctvyuan)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="626" cy="120.1094" fill="#FEFECE" filter="url(#f1v433rctvyuan)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="589.5" y="1365.5957">Central</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="577.5" y="1382.084">Service API</text><path d="M597,1389.0371 L597,1413.0371 M597,1401.0371 L614,1401.0371 " fill="none" filter="url(#f1v433rctvyuan)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="626" cy="1401.0371" fill="#FEFECE" filter="url(#f1v433rctvyuan)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="52" x="671.5" y="113.1094"/><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="52" x="667.5" y="117.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="676.5" y="137.6445">Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="674.5" y="154.1328">Topic</text><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="52" x="671.5" y="1352.0605"/><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="52" x="667.5" y="1356.0605"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="676.5" y="1376.5957">Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="674.5" y="1393.084">Topic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="794.5" y="133.1563">Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="793" y="149.6445">Event</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="784.5" y="166.1328">Handler</text><ellipse cx="814.5" cy="103.6211" fill="#FEFECE" filter="url(#f1v433rctvyuan)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="810.5,91.6211,816.5,86.6211,814.5,91.6211,816.5,96.6211,810.5,91.6211" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="794.5" y="1365.5957">Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="793" y="1382.084">Event</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="784.5" y="1398.5723">Handler</text><ellipse cx="814.5" cy="1417.5254" fill="#FEFECE" filter="url(#f1v433rctvyuan)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="810.5,1405.5254,816.5,1400.5254,814.5,1405.5254,816.5,1410.5254,810.5,1405.5254" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="63.4648" style="stroke: #A80036; stroke-width: 1.5;" width="69" x="872" y="96.6211"/><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="63.4648" style="stroke: #A80036; stroke-width: 1.5;" width="69" x="868" y="100.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="875" y="121.1563">Position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="883.5" y="137.6445">Topic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="883" y="154.1328">dfsp2</text><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="63.4648" style="stroke: #A80036; stroke-width: 1.5;" width="69" x="872" y="1352.0605"/><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="63.4648" style="stroke: #A80036; stroke-width: 1.5;" width="69" x="868" y="1356.0605"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="875" y="1376.5957">Position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="883.5" y="1393.084">Topic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="883" y="1409.5723">dfsp2</text><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="52" x="959" y="113.1094"/><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="52" x="955" y="117.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="962.5" y="137.6445">Event</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="962" y="154.1328">Topic</text><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="52" x="959" y="1352.0605"/><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="52" x="955" y="1356.0605"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="962.5" y="1376.5957">Event</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="962" y="1393.084">Topic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="1025" y="133.1563">Position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1034" y="149.6445">Event</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1025.5" y="166.1328">Handler</text><ellipse cx="1055.5" cy="103.6211" fill="#FEFECE" filter="url(#f1v433rctvyuan)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1051.5,91.6211,1057.5,86.6211,1055.5,91.6211,1057.5,96.6211,1051.5,91.6211" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="1025" y="1365.5957">Position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1034" y="1382.084">Event</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1025.5" y="1398.5723">Handler</text><ellipse cx="1055.5" cy="1417.5254" fill="#FEFECE" filter="url(#f1v433rctvyuan)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1051.5,1405.5254,1057.5,1400.5254,1055.5,1405.5254,1057.5,1410.5254,1051.5,1405.5254" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="72" x="1120.5" y="113.1094"/><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="72" x="1116.5" y="117.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="1123.5" y="137.6445">Transfer</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="1133.5" y="154.1328">Topic</text><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="72" x="1120.5" y="1352.0605"/><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="72" x="1116.5" y="1356.0605"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="1123.5" y="1376.5957">Transfer</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="1133.5" y="1393.084">Topic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="1234.5" y="133.1563">Transfer</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1245" y="149.6445">Event</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1236.5" y="166.1328">Handler</text><ellipse cx="1266.5" cy="103.6211" fill="#FEFECE" filter="url(#f1v433rctvyuan)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1262.5,91.6211,1268.5,86.6211,1266.5,91.6211,1268.5,96.6211,1262.5,91.6211" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="1234.5" y="1365.5957">Transfer</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1245" y="1382.084">Event</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1236.5" y="1398.5723">Handler</text><ellipse cx="1266.5" cy="1417.5254" fill="#FEFECE" filter="url(#f1v433rctvyuan)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1262.5,1405.5254,1268.5,1400.5254,1266.5,1405.5254,1268.5,1410.5254,1262.5,1405.5254" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="1321" y="113.1094"/><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="1317" y="117.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="1324" y="137.6445">Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="1344.5" y="154.1328">Topic</text><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="1321" y="1352.0605"/><rect fill="#FEFECE" filter="url(#f1v433rctvyuan)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="1317" y="1356.0605"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="1324" y="1376.5957">Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="1344.5" y="1393.084">Topic</text><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="264.416" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="329.5" y="328.2598"/><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="1163.9746" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="495.5" y="179.0859"/><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="117.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="692.5" y="445.8125"/><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="1163.9746" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="809.5" y="179.0859"/><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="1163.9746" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1050.5" y="179.0859"/><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="1163.9746" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1261.5" y="179.0859"/><path d="M13,186.0859 L366,186.0859 L366,193.0859 L356,203.0859 L13,203.0859 L13,186.0859 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1149.9746" style="stroke: #000000; stroke-width: 2.0;" width="1425" x="13" y="186.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="308" x="28" y="199.6543">DFSP2 sends a Fulfil Success Transfer request</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="116.5" x2="158.5" y1="270.6387" y2="270.6387"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="158.5" x2="158.5" y1="270.6387" y2="283.6387"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="117.5" x2="158.5" y1="283.6387" y2="283.6387"/><polygon fill="#A80036" points="127.5,279.6387,117.5,283.6387,127.5,287.6387,123.5,283.6387" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="123.5" y="242.9307">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="136.5" y="219.9648">Retrieve fulfilment string</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="136.5" y="235.2754">generated during the quoting</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="136.5" y="250.5859">process or regenerate it using</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="136.5" y="265.8965">Local secret</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="220.5" y="265.8965">and</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="68" x="247.5" y="265.8965">ILP Packet</text><polygon fill="#A80036" points="317.5,324.2598,327.5,328.2598,317.5,332.2598,321.5,328.2598" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="116.5" x2="323.5" y1="328.2598" y2="328.2598"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="123.5" y="315.8623">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="136.5" y="308.207">PUT - /transfers/&lt;ID&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="136.5" y="323.5176">(&lt;IlpFulfilment&gt;   payload)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="339.5" x2="381.5" y1="388.1914" y2="388.1914"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="381.5" x2="381.5" y1="388.1914" y2="401.1914"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340.5" x2="381.5" y1="401.1914" y2="401.1914"/><polygon fill="#A80036" points="350.5,397.1914,340.5,401.1914,350.5,405.1914,346.5,401.1914" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="346.5" y="368.1387">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="359.5" y="352.8281">Validate incoming</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="359.5" y="368.1387">token and originator</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="359.5" y="383.4492">matching Payee</text><polygon fill="#A80036" points="680.5,441.8125,690.5,445.8125,680.5,449.8125,684.5,445.8125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="339.5" x2="686.5" y1="445.8125" y2="445.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="346.5" y="433.415">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="183" x="359.5" y="425.7598">Produce fulfil event for Payee</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="359.5" y="441.0703">(type: 'fulfil', action: 'commit')</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="702.5" x2="744.5" y1="521.0547" y2="521.0547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="744.5" x2="744.5" y1="521.0547" y2="534.0547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="703.5" x2="744.5" y1="534.0547" y2="534.0547"/><polygon fill="#A80036" points="713.5,530.0547,703.5,534.0547,713.5,538.0547,709.5,534.0547" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="709.5" y="493.3467">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="722.5" y="470.3809">Event is</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="722.5" y="485.6914">replicated as</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="722.5" y="501.002">configured</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="722.5" y="516.3125">(ACKS=all)</text><polygon fill="#A80036" points="350.5,559.3652,340.5,563.3652,350.5,567.3652,346.5,563.3652" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="344.5" x2="696.5" y1="563.3652" y2="563.3652"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="356.5" y="558.623">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="369.5" y="558.623">Replication acknoledgements</text><polygon fill="#A80036" points="127.5,588.6758,117.5,592.6758,127.5,596.6758,123.5,592.6758" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="121.5" x2="333.5" y1="592.6758" y2="592.6758"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="133.5" y="587.9336">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="146.5" y="587.9336">Respond HTTP - 200 (OK)</text><polygon fill="#A80036" points="708.5,617.9863,698.5,621.9863,708.5,625.9863,704.5,621.9863" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="702.5" x2="808.5" y1="621.9863" y2="621.9863"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="714.5" y="617.2441">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="727.5" y="617.2441">Consume</text><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="349.5" x="664.5" y="629.9863"/><polygon fill="#EEEEEE" points="664.5,629.9863,728.5,629.9863,728.5,636.9863,718.5,646.9863,664.5,646.9863,664.5,629.9863" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="677.5" y="644.5547">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="710.25" y="663.5547">Fulfil Handler Consume (Success) {2.1.1.}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="714.25" y="678.8652"/><polygon fill="#A80036" points="894.5,708.2285,904.5,712.2285,894.5,716.2285,898.5,712.2285" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="819.5" x2="900.5" y1="712.2285" y2="712.2285"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="826.5" y="707.4863">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="839.5" y="707.4863">Produce</text><polygon fill="#A80036" points="917.5,737.5391,907.5,741.5391,917.5,745.5391,913.5,741.5391" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="911.5" x2="1049.5" y1="741.5391" y2="741.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="923.5" y="736.7969">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="945.5" y="736.7969">Consume</text><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="330.5" x="865" y="749.5391"/><polygon fill="#EEEEEE" points="865,749.5391,929,749.5391,929,756.5391,919,766.5391,865,766.5391,865,749.5391" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="878" y="764.1074">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="891.75" y="783.1074">Position Handler Consume (Success) {2.1.2.}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="895.75" y="798.418"/><polygon fill="#A80036" points="1144.5,827.7813,1154.5,831.7813,1144.5,835.7813,1148.5,831.7813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1060.5" x2="1150.5" y1="831.7813" y2="831.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1067.5" y="827.0391">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="1089.5" y="827.0391">Produce</text><polygon fill="#A80036" points="1167.5,857.0918,1157.5,861.0918,1167.5,865.0918,1163.5,861.0918" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1161.5" x2="1260.5" y1="861.0918" y2="861.0918"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1173.5" y="856.3496">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="1195.5" y="856.3496">Consume</text><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="465" x="952" y="869.0918"/><polygon fill="#EEEEEE" points="952,869.0918,1016,869.0918,1016,876.0918,1006,886.0918,952,886.0918,952,869.0918" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="965" y="883.6602">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="1045.5" y="902.6602">Transfer Handler Consume (Success) {2.1.3.}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1049.5" y="917.9707"/><polygon fill="#A80036" points="1355.5,947.334,1365.5,951.334,1355.5,955.334,1359.5,951.334" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1271.5" x2="1361.5" y1="951.334" y2="951.334"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1278.5" y="946.5918">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="1300.5" y="946.5918">Produce</text><polygon fill="#A80036" points="1355.5,976.6445,1365.5,980.6445,1355.5,984.6445,1359.5,980.6445" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="505.5" x2="1361.5" y1="980.6445" y2="980.6445"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="512.5" y="975.9023">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="534.5" y="975.9023">Consume</text><path d="M23,995.6445 L90,995.6445 L90,1002.6445 L80,1012.6445 L23,1012.6445 L23,995.6445 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="1405" x="23" y="995.6445"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="38" y="1009.2129">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="105" y="1008.2793">[action == 'commit']</text><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="1387" x="30" y="1037.9551"/><polygon fill="#EEEEEE" points="30,1037.9551,94,1037.9551,94,1044.9551,84,1054.9551,30,1054.9551,30,1037.9551" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="43" y="1052.5234">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="579.5" y="1071.5234">Send notification to Participant (Payer) {1.1.4.}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="583.5" y="1086.834"/><polygon fill="#A80036" points="68.5,1116.1973,58.5,1120.1973,68.5,1124.1973,64.5,1120.1973" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="62.5" x2="494.5" y1="1120.1973" y2="1120.1973"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="74.5" y="1115.4551">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="96.5" y="1115.4551">Send callback notification</text><polygon fill="#A80036" points="1355.5,1152.5078,1365.5,1156.5078,1355.5,1160.5078,1359.5,1156.5078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="505.5" x2="1361.5" y1="1156.5078" y2="1156.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="512.5" y="1151.7656">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="534.5" y="1151.7656">Consume</text><path d="M82,1171.5078 L149,1171.5078 L149,1178.5078 L139,1188.5078 L82,1188.5078 L82,1171.5078 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="1346" x="82" y="1171.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="97" y="1185.0762">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="164" y="1184.1426">[action == 'commit']</text><rect fill="#FFFFFF" filter="url(#f1v433rctvyuan)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="1328" x="89" y="1213.8184"/><polygon fill="#EEEEEE" points="89,1213.8184,153,1213.8184,153,1220.8184,143,1230.8184,89,1230.8184,89,1213.8184" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="102" y="1228.3867">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="290" x="608" y="1247.3867">Send notification to Participant (Payee) {1.1.4.}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="612" y="1262.6973"/><polygon fill="#A80036" points="127.5,1292.0605,117.5,1296.0605,127.5,1300.0605,123.5,1296.0605" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="121.5" x2="494.5" y1="1296.0605" y2="1296.0605"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="133.5" y="1291.3184">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="155.5" y="1291.3184">Send callback notification</text><!--
@startuml
title 2.1.0. DFSP2 sends a Fulfil Success Transfer request

autonumber


actor "DFSP1\nPayer" as DFSP1
actor "DFSP2\nPayee" as DFSP2
boundary "ML API Adapter" as MLAPI
control "ML API Notification\nEvent Handler" as NOTIFY_HANDLER
boundary "Central\nService API" as CSAPI
collections "Fulfil\nTopic" as TOPIC_FULFIL
control "Fulfil\nEvent\nHandler" as FULF_HANDLER
collections "Position\nTopic\ndfsp2" as TOPIC_POSITION_DFSP2
control "Position\nEvent\nHandler" as POS_HANDLER
collections "Transfer\nTopic" as TOPIC_TRANSFERS
collections "Event\nTopic" as TOPIC_EVENTS
control "Transfer\nEvent\nHandler" as TRANS_HANDLER
collections "Notification\nTopic" as TOPIC_NOTIFICATIONS

box "Financial\nService Providers" #lightGray
	participant DFSP1
	participant DFSP2
end box

box "ML API Adapter Service" #LightBlue
	participant MLAPI
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
    participant CSAPI
	participant TOPIC_FULFIL
    participant FULF_HANDLER
    participant TOPIC_POSITION_DFSP2
    participant TOPIC_EVENTS
    participant POS_HANDLER
    participant TOPIC_TRANSFERS
    participant TRANS_HANDLER
    participant TOPIC_NOTIFICATIONS
end box

activate NOTIFY_HANDLER
activate FULF_HANDLER
activate POS_HANDLER
activate TRANS_HANDLER
group DFSP2 sends a Fulfil Success Transfer request
    DFSP2 <-> DFSP2: Retrieve fulfilment string\ngenerated during the quoting\nprocess or regenerate it using\n**Local secret** and **ILP Packet**
    DFSP2 -> MLAPI: PUT - /transfers/<ID>\n(<IlpFulfilment>   payload)
    activate MLAPI
    MLAPI -> MLAPI: Validate incoming\ntoken and originator\nmatching Payee
    MLAPI -> TOPIC_FULFIL: Produce fulfil event for Payee\n(type: 'fulfil', action: 'commit')
    activate TOPIC_FULFIL
    TOPIC_FULFIL <-> TOPIC_FULFIL: Event is\nreplicated as\nconfigured\n(ACKS=all)
    TOPIC_FULFIL - -> MLAPI: Replication acknoledgements
    deactivate TOPIC_FULFIL
    MLAPI - -> DFSP2: Respond HTTP - 200 (OK)
    deactivate MLAPI
    TOPIC_FULFIL <- FULF_HANDLER: Consume
    ref over TOPIC_FULFIL, TOPIC_EVENTS:  Fulfil Handler Consume (Success) {2.1.1.} \n
    FULF_HANDLER -> TOPIC_POSITION_DFSP2: Produce
    TOPIC_POSITION_DFSP2 <- POS_HANDLER: Consume
    ref over TOPIC_POSITION_DFSP2, TOPIC_TRANSFERS:  Position Handler Consume (Success) {2.1.2.} \n
    POS_HANDLER -> TOPIC_TRANSFERS: Produce
    TOPIC_TRANSFERS <- TRANS_HANDLER: Consume
    ref over TOPIC_EVENTS, TOPIC_NOTIFICATIONS: Transfer Handler Consume (Success) {2.1.3.} \n
    TRANS_HANDLER -> TOPIC_NOTIFICATIONS: Produce
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: Consume
    opt action == 'commit'
        |||
        ref over DFSP1, TOPIC_NOTIFICATIONS: Send notification to Participant (Payer) {1.1.4.} \n
        NOTIFY_HANDLER -> DFSP1: Send callback notification
    end
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: Consume
    opt action == 'commit'
        |||
        ref over DFSP2, TOPIC_NOTIFICATIONS: Send notification to Participant (Payee) {1.1.4.} \n
        NOTIFY_HANDLER -> DFSP2: Send callback notification
    end
    |||
end
deactivate TRANS_HANDLER
deactivate POS_HANDLER
deactivate FULF_HANDLER
deactivate NOTIFY_HANDLER
@enduml

PlantUML version 1.2018.05(Sat May 05 23:00:17 EEST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_131-b11
Operating System: Mac OS X
OS Version: 10.13.5
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>