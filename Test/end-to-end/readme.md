# Scenario Tests

### Setup

See [Jmeter setup here](../README.md#setup)

### Test Configuration

This is a functional end-to-end test and is driven by several components
- environment configuration
- test case data

#### Environment Configuration:
The main configuration is external to the test in a csv file called **scenarioConfigData.csv**. This file should be in the same directory as the jmx file for the test. It contains the:
* the name of the two DFSP servers - these can be made the same server
* the USSD port number - it assumes that both servers use the same port number
* the expected total fee - it assumes the fee is the same in both directions
These values can be adapted to your local environment by changing the file.

#### Test Case Data
There are two versions of the test. In one version, **Scenario Test (new users).jmx**, two accounts are created dynamically and used for a transfer and an an invoice. The user created will create users with a name in the format: TestUser_DDDDDDD where the D's are digits. Those same digits are used for the user's national ID and PIN. The user's first name is always John. That version of the test writes two files:
* ScenarioUser1.csv
* ScenarioUser2.csv

These files contain the user digits, and the user number generated by the system.

In the second version, **Scenario Test (existing users from file).jmx**, the user csv files are used to send money and invoices between the existing users with creating new users or accounts.

### Test Functionality
The tests perform these scenarios:
* Create new users on each DFSP
* Check the initial balance (the amount is stored, but not validated)
* Send Money from User1 to User2
* Check the final balances and verify they are correct including the fee
* Send Invoice from User1 to User2
* User2 approves the invoice, sending money back to User1
* Balances are checked

Scenarios Not tested: account management, sub-accounts

### Logging and Output
* scenarioTest.log - produced by the test. Shows success/failure by step and performance info
* jmeter.log - produced by jmeter. Shows test failure info.

Tests can be modified to send results in mail.
